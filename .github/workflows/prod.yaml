name: prod

on:
  push:
    branches: [master]

jobs:
  deploy:
    runs-on: [self-hosted]
    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Deploy to Docker Hub Production
        run:
            pwd &&
            ls -lash &&
            whoami &&
            ls -lash /home/runner/ci &&
            ls -lash /home/runner/ci/nozich-git &&
            ls -lash ~/ci &&
            ls -lash ~/ci/nozich-git &&
            cp /home/runner/ci/nozich-inc/prod.env .env &&
            source .env &&
            echo ${process.env.DOCKER_ACCESS_TOKEN} | docker login -u nozich --password-stdin &&
            echo "bun version $(bun -v)" &&
            echo "node version $(node -v)" &&
            echo "npm version $(npm -v)" &&
            curl -fsSL https://bun.sh/install | bash &&
            /home/runner/.bun/bin/bun --bun run --env-file=./.env ./push.js
